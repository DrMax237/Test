{"version":3,"sources":["assets\\Scripts\\Helper.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const { ccclass, property, menu, executeInEditMode } = cc._decorator;\n\nenum ComponentType {\n    ParticleSystem = 0,\n    Animation,\n    Spine,\n}\n\nenum ControlType {\n    AllKeys = 0,\n    ExactKey,\n}\n\nenum KeyType {\n    AllKeys = 0,\n    ExactKey,\n}\n\n@ccclass('PlayInfo')\nclass PlayInfo {\n\n    @property() delay: number = 0;\n    @property(cc.Node) node: cc.Node = null;\n\n}\n\n@ccclass\n@menu('Prohor/Helper')\n@executeInEditMode\nexport default class Helper extends cc.Component {\n\n    @property({ type: cc.Enum(ComponentType) }) component: ComponentType = ComponentType.ParticleSystem;\n    @property({ type: cc.Enum(ControlType) }) control: ControlType = ControlType.AllKeys;\n\n    @property({ type: cc.Enum(cc.macro.KEY), visible() { return this.control === ControlType.ExactKey } }) key: cc.macro.KEY = cc.macro.KEY.b;\n\n    @property _autofind: boolean = false;\n    @property\n    set Autofind(v: boolean) {\n        this._autofind = v;\n        this._autofind && this.autofindNodes();\n    };\n    get Autofind(): boolean { return this._autofind };\n\n    @property([PlayInfo]) playInfo: PlayInfo[] = [];\n\n    onLoad() {\n        if (!CC_EDITOR) {\n            cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n        }\n    }\n\n    private onKeyDown(event) {\n        switch (this.control) {\n            case ControlType.AllKeys:\n                this.play();\n                break;\n            case ControlType.ExactKey:\n                if (event.keyCode === this.key) {\n                    this.play();\n                }\n                break;\n        }\n    }\n\n    private autofindNodes() {\n        const children = this.node.children;\n        this.playInfo = [];\n\n        children.forEach(child => {\n            const info = new PlayInfo();\n            info.node = child;\n\n            this.playInfo.push(info);\n        });\n    }\n\n    private play() {\n        this.playInfo.forEach(info => {\n            this.scheduleOnce(() => {\n                switch (this.component) {\n                    case ComponentType.Animation:\n                        info.node.getComponent(cc.Animation).play();\n                        break;\n                    case ComponentType.ParticleSystem:\n                        info.node.getComponent(cc.ParticleSystem).resetSystem();\n                        break;\n                    case ComponentType.Spine:\n                        const spine = info.node.getComponent(sp.Skeleton);\n                        spine.setAnimation(0, spine.animation, spine.loop);\n                        break;\n                }\n            }, info.delay);\n        });\n    }\n}"]}